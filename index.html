 <!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Fitness Hub ‚Äì All in One</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Tailwind CSS -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body{
  transition: background 0.4s ease, color 0.4s ease;
}
.dark{background:#0f172a;color:white;}
.light{background:#f8fafc;color:black;}
.card{background:rgba(0,0,0,.6);border-radius:12px;}
</style>
</head>

<body class="dark">

<!-- NAVBAR -->
<nav class="flex justify-between items-center p-4 bg-black/70">
<h1 class="text-xl font-bold">Fitness Hub</h1>
<div>
<button onclick="toggleTheme()" class="mr-3 px-3 py-1 border rounded">Theme</button>
<button id="logoutBtn" onclick="logout()" class="hidden bg-red-500 px-3 py-1 rounded">Logout</button>
</div>
</nav>

<!-- LOGIN -->
<section id="loginSection" class="flex justify-center mt-12">
<div class="card p-6 w-80">
<h2 class="text-center mb-4 text-lg">Login</h2>
<input id="email" class="w-full p-2 mb-3 text-black rounded" placeholder="Email">
<input id="password" type="password" class="w-full p-2 mb-3 text-black rounded" placeholder="Password">
<button onclick="login()" class="bg-blue-500 w-full p-2 rounded">Login</button>
</div>
</section>

<!-- USER DASHBOARD -->
<section id="userDashboard" class="hidden p-6 max-w-md mx-auto">

<h2 class="text-2xl text-center mb-4">User Dashboard</h2>

<!-- DIET -->
<input id="weight" type="number" placeholder="Weight (kg)" class="w-full p-2 mb-3 text-black rounded">
<input id="height" type="number" placeholder="Height (cm)" class="w-full p-2 mb-3 text-black rounded">

<select id="goal" class="w-full p-2 mb-3 text-black rounded">
<option value="loss">Weight Loss</option>
<option value="maintain">Maintain</option>
<option value="gain">Muscle Gain</option>
</select>

<button onclick="calculateDiet()" class="bg-green-500 w-full p-2 rounded">Calculate Diet</button>

<p id="dietResult" class="mt-3 font-semibold text-center"></p>
<p id="bmiResult" class="text-center"></p>

<table id="dietTable" class="w-full mt-4 bg-white text-black hidden">
<tr class="bg-gray-200">
<th class="p-2">Meal</th><th class="p-2">Food</th><th class="p-2">Calories</th>
</tr>
</table>

<button id="pdfBtn" onclick="downloadPDF()" class="bg-orange-500 w-full mt-3 p-2 rounded hidden">
Download Diet PDF
</button>

<hr class="my-6">

<!-- WATER TRACKER -->
<h3 class="text-xl text-center mb-3">üíß Water Intake Tracker</h3>
<div class="bg-black/60 p-4 rounded text-center">
<p class="mb-2">Daily Goal: <b>3 Liters</b></p>
<div class="flex justify-center gap-3 mb-3">
<button onclick="addWater(250)" class="bg-blue-500 px-4 py-2 rounded">+250ml</button>
<button onclick="addWater(500)" class="bg-blue-600 px-4 py-2 rounded">+500ml</button>
</div>
<p id="waterStatus" class="font-semibold"></p>
<div class="w-full bg-gray-700 rounded h-4 mt-3">
<div id="waterBar" class="bg-blue-400 h-4 rounded" style="width:0%"></div>
</div>
</div>

<hr class="my-6">

<!-- WORKOUT -->
<h3 class="text-xl text-center mb-3">üèãÔ∏è Workout Planner</h3>
<select id="workoutGoal" class="w-full p-2 mb-3 text-black rounded">
<option value="loss">Weight Loss</option>
<option value="maintain">General Fitness</option>
<option value="gain">Muscle Gain</option>
</select>

<button onclick="generateWorkout()" class="bg-purple-500 w-full p-2 rounded">
Generate Workout Plan
</button>

<ul id="workoutList" class="mt-4 space-y-2"></ul>
</section>

<!-- ADMIN DASHBOARD -->
<section id="adminDashboard" class="hidden p-6 max-w-xl mx-auto">
<h2 class="text-2xl text-center mb-4">Admin Dashboard</h2>
<table class="w-full bg-black/60 border text-sm">
<thead class="bg-black">
<tr><th class="border p-2">Email</th><th class="border p-2">Role</th></tr>
</thead>
<tbody id="userTable"></tbody>
</table>
</section>

<!-- FIREBASE + LOGIC -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, doc, getDoc, getDocs, collection }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

/* üî• YOUR FIREBASE CONFIG */
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  projectId: "YOUR_PROJECT_ID"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

/* LOGIN */
window.login = async ()=>{
  try{
    const cred = await signInWithEmailAndPassword(auth,email.value,password.value);
    const snap = await getDoc(doc(db,"users",cred.user.uid));
    showDashboard(snap.data().role);
  }catch(e){alert(e.message);}
};

/* LOGOUT */
window.logout = async ()=>{ await signOut(auth); location.reload(); };

/* AUTH STATE */
onAuthStateChanged(auth, async user=>{
  if(user){
    const snap = await getDoc(doc(db,"users",user.uid));
    showDashboard(snap.data().role);
  }
});

/* DASHBOARD */
function showDashboard(role){
  loginSection.classList.add("hidden");
  logoutBtn.classList.remove("hidden");
  role==="admin"?(adminDashboard.classList.remove("hidden"),loadUsers()):
  userDashboard.classList.remove("hidden");
}

/* ADMIN USERS */
async function loadUsers(){
  const q = await getDocs(collection(db,"users"));
  userTable.innerHTML="";
  q.forEach(d=>{
    userTable.innerHTML+=`
    <tr><td class="border p-2">${d.data().email}</td>
    <td class="border p-2">${d.data().role}</td></tr>`;
  });
}

/* DIET */
window.calculateDiet=()=>{
  const w=+weight.value,h=+height.value/100;
  if(w<=0||h<=0)return alert("Invalid input");
  const bmi=(w/(h*h)).toFixed(1);
  let cal=w*24;
  if(goal.value==="loss")cal-=500;
  if(goal.value==="gain")cal+=500;
  cal=Math.max(cal,1200);
  dietResult.textContent=`Calories/day: ${cal}`;
  bmiResult.textContent=`BMI: ${bmi}`;
  generateDiet(cal);
};

/* DIET TABLE */
function generateDiet(cal){
  const meals=[
    ["Breakfast","Oats + Fruit",.3],
    ["Lunch","Rice + Dal",.35],
    ["Snack","Nuts",.15],
    ["Dinner","Roti + Veg",.2]
  ];
  dietTable.innerHTML=`<tr class="bg-gray-200"><th>Meal</th><th>Food</th><th>Calories</th></tr>`;
  meals.forEach(m=>{
    dietTable.innerHTML+=`
    <tr><td>${m[0]}</td><td>${m[1]}</td><td>${Math.round(cal*m[2])}</td></tr>`;
  });
  dietTable.classList.remove("hidden");
  pdfBtn.classList.remove("hidden");
}

/* PDF */
window.downloadPDF=()=>{
  const{jsPDF}=window.jspdf;
  const pdf=new jsPDF();
  pdf.text("Personalized Diet Plan",20,20);
  let y=40;
  [...dietTable.rows].forEach(r=>{
    pdf.text([...r.cells].map(c=>c.innerText).join(" | "),20,y);
    y+=10;
  });
  pdf.save("Diet_Plan.pdf");
};

/* WATER TRACKER */
const WATER_GOAL=3000;
let waterToday=+localStorage.getItem("water")||0;

function updateWater(){
  const p=Math.min(waterToday/WATER_GOAL*100,100);
  waterBar.style.width=p+"%";
  waterStatus.textContent=`Consumed: ${waterToday} ml`+(waterToday>=WATER_GOAL?" ‚úÖ":"");
}
window.addWater=(a)=>{
  waterToday+=a;
  localStorage.setItem("water",waterToday);
  updateWater();
};
updateWater();

/* WORKOUT */
window.generateWorkout=()=>{
  const g=workoutGoal.value;
  let plan=[];
  if(g==="loss") plan=[
    "Jump Rope ‚Äì 10 mins","Squats ‚Äì 3√ó15","Mountain Climbers ‚Äì 3√ó20","Plank ‚Äì 30s√ó3","Walk ‚Äì 20 mins"];
  else if(g==="gain") plan=[
    "Push-ups ‚Äì 4√ó12","Squats ‚Äì 4√ó10","Bench Press ‚Äì 3√ó8","Bicep Curls ‚Äì 3√ó12","Deadlift ‚Äì 3√ó6"];
  else plan=[
    "Stretching ‚Äì 5 mins","Jogging ‚Äì 15 mins","Lunges ‚Äì 3√ó12","Plank ‚Äì 30s√ó2","Yoga ‚Äì 10 mins"];
  workoutList.innerHTML="";
  plan.forEach(p=>workoutList.innerHTML+=`<li class="bg-black/60 p-3 rounded">‚úî ${p}</li>`);
};

/* THEME */
function applyTheme(t){document.body.className=t;localStorage.setItem("theme",t);}
window.toggleTheme=()=>applyTheme(document.body.classList.contains("dark")?"light":"dark");
applyTheme(localStorage.getItem("theme")||(matchMedia("(prefers-color-scheme:dark)").matches?"dark":"light"));
</script>

</body>
</html>

